---
title: Pick image from gallery
---

Patrol provides functionality to pick an image from the Android and iOS gallery using the `pickImageFromGallery` method from the native automator.

<Info>
  Due to differences between devices and gallery apps, this method may not work on 100% of devices, but it should work on most. If the device you are testing on is not working with the default selectors, you can provide your own selectors. To get native selectors, you can use the [Patrol DevTools Extension](https://patrol.leancode.co/documentation/patrol-devtools-extension).
</Info>

## How it works

This method performs the following actions:

1. Opens the gallery.
2. Selects an image (by default, the first image or the one at the provided index).
3. Confirms the selection.

You can provide a custom selector for the image using the `imageSelector` parameter. If no custom selector is provided, default selectors will be used. Alternatively, you can specify an `index` to select the nth image.

The table below shows the default native selectors that the `pickImageFromGallery()` method uses internally for each platform:

| Platform                   | Image Selector (default)                                      |
| -------------------------- | ------------------------------------------------------------ |
| Physical/Emulator Android  | `com.google.android.documentsui:id/icon_thumb` (API < 34) or `com.google.android.providers.media.module:id/icon_thumbnail` (API 34+) |
| Simulator and Physical iOS | `IOSElementType.image` (instance: 1+)                        |

<Info>
  This method should work without custom selectors on iOS devices. For Android, it should work with most emulators and Pixel physical devices.
</Info>

## Examples

When you are using supported devices, you can use this method without any additional arguments:

```dart
import 'package:example/main.dart';
import 'package:patrol/patrol.dart';

void main() {
  patrolTest(
    'Pick an image from gallery on Android or iOS',
    ($) async {
      await $.pumpWidgetAndSettle(const MyApp());
      await $.tap(#addPhotoButton); // Opens the gallery picker in your app
      await $.native2.grantPermissionWhenInUse(); // Some devices require permission to be granted before picking an image
      await $.native2.pickImageFromGallery(index: 0); // Picks the first image from the gallery
    },
  );
}
```

When you are using unsupported devices, you can provide your own selectors:

```dart
import 'package:example/main.dart';
import 'package:patrol/patrol.dart';

void main() {
  patrolTest(
    'Pick an image from gallery with custom selectors',
    ($) async {
      await $.pumpWidgetAndSettle(const MyApp());
      await $.tap(#addPhotoButton); // Opens the gallery picker in your app
      await $.native2.grantPermissionWhenInUse(); // Some devices require permission to be granted before picking an image
      await $.native2.pickImageFromGallery(
        imageSelector: NativeSelector(
          android: AndroidSelector(
            resourceName: 'com.oplus.gallery:id/image',
          ),
          ios: IOSSelector(label: 'Photo'),
        ),
      );
    },
  );
}
```

<Info>
  You can also use `pickMultipleImagesFromGallery` to select more than one image. See the API reference for details.
</Info> 