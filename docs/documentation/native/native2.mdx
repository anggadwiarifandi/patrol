---
title: Native Automation 2.0 (native2)
---

Patrol's **native2** introduces a unified approach to native mobile automation, providing cross-platform selectors and methods that work seamlessly across both iOS and Android platforms. This evolution from the original native automation API simplifies test writing while providing more powerful selector capabilities.

## What is native2?

<Info>
Native2 is available starting from Patrol version `3.6.0`.
</Info>

Native2 provides a **unified API** for both iOS and Android platforms, eliminating the need to write separate platform-specific code. Instead of maintaining different methods for each platform, you can now use a single method with platform-specific selectors.


## Unified Methods vs. Separate Platform Methods

### Before native2 (Separate Methods)

In the original native automation API, you needed separate methods for iOS and Android:

```dart
// Before: Separate methods for each platform
if (Platform.isAndroid) {
  await $.native.tap(Selector(text: 'Login'));
} else if (Platform.isIOS) {
  await $.native.tap(Selector(label: 'Login'));
}

// Text input also required platform-specific calls
if (Platform.isAndroid) {
  await $.native.enterText(
    Selector(contentDescription: 'Email field'),
    text: 'john@example.com',
  );
} else if (Platform.isIOS) {
  await $.native.enterText(
    Selector(identifier: 'emailField'),
    text: 'john@example.com',
  );
}
```

### With native2 (Unified Methods)

Native2 provides a single method that works across both platforms:

```dart
// After: Single unified method with platform-specific selectors
await $.native2.tap(
  NativeSelector(
    android: AndroidSelector(
      text: 'Login',
    ),
    ios: IOSSelector(
      label: 'Login',
    ),
  ),
);

// Text input with unified method
await $.native2.enterText(
  NativeSelector(
    android: AndroidSelector(
      contentDescription: 'Email field',
    ),
    ios: IOSSelector(
      identifier: 'emailField',
    ),
  ),
  text: 'john@example.com',
);
```

## Core Components

### NativeSelector

The `NativeSelector` is the central component that aggregates platform-specific selectors:

```dart
class NativeSelector {
  const NativeSelector({this.android, this.ios});

  /// Android selector
  final AndroidSelector? android;
  
  /// iOS selector  
  final IOSSelector? ios;
}
```

### Text Input Operations

```dart
// Enter text in username field
await $.native2.enterText(
  NativeSelector(
    android: AndroidSelector(
      resourceName: 'username',
    ),
    ios: IOSSelector(
      identifier: 'usernameField',
    ),
  ),
  text: 'testuser@example.com',
);

// Enter password in secure field
await $.native2.enterText(
  NativeSelector(
    android: AndroidSelector(
      contentDescription: 'Password',
    ),
    ios: IOSSelector(
      elementType: IOSElementType.secureTextField,
    ),
  ),
  text: 'secretpassword',
);
```

### Advanced Selector Usage

```dart
// Find elements by instance (when multiple elements match)
await $.native2.tap(
  NativeSelector(
    android: AndroidSelector(
      className: 'android.widget.Button',
      instance: 2, // Third button (0-indexed)
    ),
    ios: IOSSelector(
      elementType: IOSElementType.button,
      instance: 2, // Third button (0-indexed)
    ),
  ),
);

// Wait for element to become visible
await $.native2.waitUntilVisible(
  NativeSelector(
    android: AndroidSelector(
      textStartsWith: 'Welcome',
    ),
    ios: IOSSelector(
      labelStartsWith: 'Welcome',
    ),
  ),
  timeout: Duration(seconds: 10),
);
```

## Migration from Legacy Native API

When migrating from the legacy native API to native2:

1. **Remove platform checks, and use `$.native2`** instead of `$.native`
2. **Use `NativeSelector`** with both `android` and `ios` properties
3. **Update method calls** to use the new unified method signatures

Native2 provides a unified API for cross-platform testing, making your Patrol tests more maintainable and reliable across both iOS and Android platforms. You can see an example of the migration [here](#before-native2-separate-methods).


